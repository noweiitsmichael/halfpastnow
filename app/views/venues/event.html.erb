<script type="text/javascript">
	 $(function() {
	 	generateValidator("#event_<%= @event.id %>",{"ajax":true});
	 });


</script>


<% @ordinal = ["th","st","nd","rd","th","th","th","th","th","th"] %>
<% @week = ["sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday"] %>
<%= form_for @event, :url => "/venues/eventEdit/" + @event.id.to_s, :html => { :multipart => true, :id => "event_" + @event.id.to_s } do |e| %>
	<% @iStrName = "event[tag_ids][]" %>

	<% @iStrId = @event.id ? "event_2#{@event.id.to_s}_tag_ids_" : "event_0_tag_ids_" %>
    <div class="main event<%= @event.id ? "" : " new"%>">
    	<%= hidden_field_tag :venue_id, @venue.id %>
		<div class="field">
		  <%= e.label :title %>
		  <%= e.text_field :title, :class => "title required" %>
		</div>
		<div class="field">
		  <%= e.label :description %>
		  <%= e.text_area :description, :class => "cleditor" %>
		</div>
		<div class="field">
		  <%= e.label :price %>
		  <%= e.text_field :price, :class => "price" %>
		</div>

		<%= render :partial => "acts", :locals => { :event => @event } %>

		<%= render :partial => "tags", :locals => { :element => @event } %>

		<%= render :partial => "occurrences_recurrences", :locals => { :e => e, :event => @event } %>

		<br>
	    <div class="field">
	    	<%= e.label :cover_image %>
			<% if @event.cover_image.nil? or Picture.where(:id => @event.cover_image).empty? %>
				<b><span style="color:red;">**** NONE: Click an image from the gallery below, or upload a new one and click it ****</span><b>
				<br>
			<% else %>
				<%= image_tag Picture.find(@event.cover_image).image_url(:cover).to_s %>
			<% end %>
		</div>
			<br>
		<div class="pictures field pic-field">
	    	<b>PICTURE GALLERY</b><br><br>
			<!-- need this to attach artist pics generated by ajax in select2.js -->

			<span class="field-for-act-pics-<%=@event.id%>">

			</span>
			<% @event.acts.each_with_index do |act, index| %>
				<span class="label-field-for-act-<%= act.id %>"></span>
				<% if !Picture.where(:image => act.fb_picture.match(/[^\/]+$/).to_s, :pictureable_id => act.id, :pictureable_type => "Act").exists? %>
					<span class="fb-pic-field"><span class="fb-pic-field-for-act-<%= act.id %>"></span></span>
				<% end %>
				<% act.pictures.each_with_index do |pic, index| %>
					<span class="pic-field"><span class="act-<%= act.id %>-pic-field-<%= index %>"></span></span>
				<% end %>
				<br>
			<% end %>
			<!-- end -->
	    

	    <%= render :partial => "pictures_events", :locals => { :e => e, :event => @event } %>
	    <br>
	    </div>

	    <div class="pics mode">
			<div class="overlay">
				<div class="window">
				</div>
			</div>
		</div>	

		<div class="actions">
    		<%= e.submit %>
    		<% if @event.id %><a href="" class="delete-event" eventId="<%= @event.id %>">Delete Event</a><% end %>
  		</div>
    </div>
<% end %>